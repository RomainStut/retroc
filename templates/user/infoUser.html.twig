{% extends 'layout.html.twig' %}

{% block title %}Profil utilisateur{% endblock %}
{% block titlepage %}Profil de {{ user.username }}{% endblock %}

{% block content %}
<div class="container">
    <div class="row">
        <div class="col-2">
            <button class="btn navbarColor01 mt-1 text-warning" ><a class="text-warning" href="{{ path('updateUser',{id:user.id }) }}">Modifier Profil</a></button>
            <button class="btn navbarColor01 mt-1 text-warning load-annonce" id="v-pills-home-tab" data-toggle="pill" href="#v-pills-home" role="tab" aria-controls="v-pills-home" aria-selected="true">Mes annonces</button>
            <button class="btn navbarColor01 mt-1 text-warning load-message" id="v-pills-profile-tab" data-toggle="pill" href="#v-pills-profile" role="tab" aria-controls="v-pills-profile" aria-selected="false">Mes messages</button>
        </div>
        <div class="col-6 offset-1 formStyle p-3 text-warning">
            <div class="row">
                <div class="col-12 mr-5" >
                    <div class="row">
                        <div class="col-4 offset-4" >
                            {% if user.profilepicture %}
                                <img src="{{ 'uploads/images/' ~ user.profilepicture }}" type="button" data-toggle="modal" data-target="#modalImage" class="btn btn-dark mr-5" style="height: 150px; width: 150px" alt=""><br>
                            {% else %}
                                <img src="{{ asset('images/yoda.jpeg' ) }}" alt="  " style=" " type="button" data-toggle="modal" data-target="#modalImage" class="btn btn-dark mr-5">
                            {% endif %}
                        </div>

                    </div>
                </div>
                <div class="col-8 ml-5">
                    <div class="col-md-12">
                    <b> Pseudo: </b>{{ user.username }}
                    </div>
                    <div class="col-md-12">
                    <b> Email: </b>{{ user.email }}
                    </div>
                    <div class="col-md-12">
                    <b>Tel: </b>{{ user.tel }}
                    </div>
                    <div class="col-md-12">
                    <b> Date de naissance: </b>{{ user.datebirth|date('d-m-Y') }}
                    </div>
                    <div class="col-md-12">
                    <b> Ville: </b>{{ user.city }}
                    </div>
                </div>


            </div>
            {% for label, messages in app.flashes %}
                {% for message in messages %}
                    <div class="alert alert-{{ label }} mt-4">
                        {{ message }}
                    </div>
                {% endfor %}
            {% endfor %}
        </div>

    </div>

    <div class="row">
        <div class="col-12" id="result">

        </div>
        <div class="col-12" id="result2">

        </div>
    </div>
</div>
{% endblock %}

{% block js %}
    <script>
        $(function(){
            $('.load-message').on('click', function(e){
                e.preventDefault();
                console.log('ok');
                $.ajax({
                    type: 'get',
                    url: "{{ path('message-user')}}",
                    timeout : 3000,
                    dataType : 'html',
                    success: function(data){

                        $('#result').html(data);
                    },
                    error: function (error) {
                        console.log(error.responseText);
                    }
                })
            })
        })

        $(function(){
            $('.load-annonce').on('click', function(e){
                e.preventDefault();
                console.log('ok');
                $.ajax({
                    type: 'get',
                    url: "{{ path('annonce-user')}}",
                    timeout : 3000,
                    dataType : 'html',
                    success: function(data){

                        $('#result2').html(data);
                    },
                    error: function (error) {
                        console.log(error.responseText);
                    }
                })
            })
        })
    </script>
{% endblock %}